<div class="app-container slide-in">
  <!-- Collapsible Stats Panels -->
  <div class="stats-panels-container" *ngIf="wordStats">
    <div class="stats-panel" 
         [class.expanded]="statsPanelExpanded"
         (mouseenter)="expandStatsPanel()"
         (mouseleave)="collapseStatsPanel()">
      
      <!-- Collapse Button -->
      <button class="stats-toggle-btn" 
              (click)="toggleStatsPanel()"
              [class.expanded]="statsPanelExpanded">
        <span class="toggle-icon">{{ statsPanelExpanded ? '‚àí' : '+' }}</span>
      </button>
      
      <!-- Stats Content -->
      <div class="stats-content" *ngIf="statsPanelExpanded">
        <div class="stat-item">
          <div class="stat-icon">üìö</div>
          <div class="stat-info">
            <div class="stat-value">{{ wordStats.total_words | number }}</div>
            <div class="stat-label">Total Words</div>
          </div>
        </div>
        
        <div class="stat-item">
          <div class="stat-icon">üìè</div>
          <div class="stat-info">
            <div class="stat-value">{{ wordStats.min_length }} - {{ wordStats.max_length }}</div>
            <div class="stat-label">Length Range</div>
          </div>
        </div>
        
        <div class="stat-item">
          <div class="stat-icon">‚öñÔ∏è</div>
          <div class="stat-info">
            <div class="stat-value">{{ wordStats.avg_length }}</div>
            <div class="stat-label">Average Length</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Mode Toggle -->
  <div class="search-toggle-container">
    <div class="search-toggle-panel" 
         [class.expanded]="searchToggleExpanded"
         (mouseenter)="expandSearchToggle()"
         (mouseleave)="collapseSearchToggle()">
      
      <!-- Toggle Switch -->
      <div class="search-toggle-switch" 
           (click)="toggleSearchMode()"
           [class.basic]="searchMode === 'basic'"
           [class.advanced]="searchMode === 'advanced'">
        <div class="toggle-slider">
          <div class="toggle-handle">
            <span class="toggle-icon">{{ searchMode === 'basic' ? 'üìñ' : '‚öôÔ∏è' }}</span>
          </div>
        </div>
      </div>
      
      <!-- Search Content -->
      <div class="search-content" *ngIf="searchToggleExpanded">
        <div class="search-mode-info">
          <div class="mode-icon">{{ searchMode === 'basic' ? 'üìñ' : '‚öôÔ∏è' }}</div>
          <div class="mode-details">
            <div class="mode-title">{{ searchMode === 'basic' ? 'Basic Search' : 'Advanced Search' }}</div>
            <div class="mode-description">
              {{ searchMode === 'basic' ? 'Dictionary lookup with Oxford integration' : 'Filter words using multiple criteria' }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Puzzle Solver Toggle -->
  <div class="puzzle-toggle-container">
    <div class="puzzle-toggle-panel" 
         [class.expanded]="puzzleToggleExpanded"
         (mouseenter)="expandPuzzleToggle()"
         (mouseleave)="collapsePuzzleToggle()">
      
      <!-- Circular Toggle Button -->
      <button class="puzzle-toggle-btn" 
              (click)="togglePuzzlePanel()"
              [class.expanded]="puzzlePanelExpanded">
        <span class="toggle-icon">üß©</span>
      </button>
      
      <!-- Puzzle Content -->
      <div class="puzzle-content" *ngIf="puzzleToggleExpanded">
        <div class="puzzle-mode-info">
          <div class="mode-icon">üß©</div>
          <div class="mode-details">
            <div class="mode-title">Puzzle Solver</div>
            <div class="mode-description">
              Interactive word pattern matching
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hero Header -->
  <header class="hero-header">
    <div class="hero-content">
      <div class="title-section floating">
        <h1 class="hero-title">
          <span class="title-primary">{{ title }}</span>
          <div class="title-tagline">Smart word filtering & puzzle solving</div>
        </h1>
      </div>
    </div>
  </header>

  <!-- Search Panels Container (Left-Right Layout) -->
  <div class="search-panels-wrapper" *ngIf="searchMode === 'basic'">
    <!-- Search Input Panel (Left Side) -->
    <div class="search-input-panel">
      <div class="search-input-container">
        <div class="search-input-header">
          <h3 class="search-input-title">
            <span class="search-icon">üîç</span>
            Word Search
          </h3>
        </div>
        
        <div class="search-form">
          <div class="search-input-group">
            <div class="input-wrapper">
              <input 
                type="text" 
                [(ngModel)]="searchWord"
                (input)="onSearchInput()"
                placeholder="Enter a word to search..."
                class="search-input">
              <div class="input-icon">üìñ</div>
            </div>
            
            <button 
              type="button" 
              (click)="searchWordBasic()"
              [disabled]="!searchWord || searchWord.trim() === ''"
              class="search-submit-btn">
              <span class="btn-icon">üîç</span>
              Search
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Search Results Panel (Right Side) -->
    <div class="search-results-panel">
    <div class="search-results-container">
      <div class="results-header">
        <h3 class="results-title">
          <span class="results-icon">üìö</span>
          Search Results
        </h3>
      </div>
      
      <div class="results-content" *ngIf="searchResult">
        <div class="horizontal-results-layout">
          <!-- Definitions Card -->
          <div class="result-card definitions-card" *ngIf="searchResult.oxford && searchResult.oxford.definitions && searchResult.oxford.definitions.length > 0">
            <div class="card-header">
              <h4 class="card-title">üìñ Definitions</h4>
              <div class="word-badge">{{ searchResult.word }}</div>
            </div>
            <div class="card-content">
              <div class="definitions-list">
                <div class="definition-item" *ngFor="let definition of searchResult.oxford.definitions">
                  {{ definition }}
                </div>
              </div>
            </div>
          </div>
          
          <!-- Word Forms Card -->
          <div class="result-card forms-card" *ngIf="searchResult.oxford && searchResult.oxford.word_forms && searchResult.oxford.word_forms.length > 0">
            <div class="card-header">
              <h4 class="card-title">üîÑ Word Forms</h4>
              <div class="word-badge">{{ searchResult.word }}</div>
            </div>
            <div class="card-content">
              <div class="word-forms-list">
                <span class="form-item" *ngFor="let form of searchResult.oxford.word_forms">{{ form }}</span>
              </div>
            </div>
          </div>
          
          <!-- Examples Card -->
          <div class="result-card examples-card" *ngIf="searchResult.oxford && searchResult.oxford.examples && searchResult.oxford.examples.length > 0">
            <div class="card-header">
              <h4 class="card-title">üí¨ Examples</h4>
              <div class="word-badge">{{ searchResult.word }}</div>
            </div>
            <div class="card-content">
              <div class="examples-list">
                <div class="example-item" *ngFor="let example of searchResult.oxford.examples">
                  {{ example }}
                </div>
              </div>
            </div>
          </div>
          
          <!-- Additional Info Card -->
          <div class="result-card info-card">
            <div class="card-header">
              <h4 class="card-title">üìö Additional Info</h4>
              <div class="word-badge">{{ searchResult.word }}</div>
            </div>
            <div class="card-content">
              <div class="additional-info-grid">
                <div class="info-item">
                  <span class="info-label">Collection Status:</span>
                  <span class="info-value" [class.in-collection]="searchResult.inCollection">
                    {{ searchResult.inCollection ? '‚úÖ In Collection' : '‚ùå Not in Collection' }}
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">Oxford Verified:</span>
                  <span class="info-value" [class.verified]="searchResult.oxford">
                    {{ searchResult.oxford ? '‚úÖ Verified' : '‚ùå Not Found' }}
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">Word Type:</span>
                  <span class="info-value">Noun/Verb/Adjective</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Pronunciation:</span>
                  <span class="info-value">/Ààw…úÀêrd/</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Origin:</span>
                  <span class="info-value">Old English</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Frequency:</span>
                  <span class="info-value">Common</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Action Button -->
        <div class="result-actions">
          <button 
            type="button" 
            (click)="addWordToCollection(searchResult.word)"
            [disabled]="searchResult.inCollection"
            class="btn btn-primary add-word-btn">
            <span class="btn-icon">‚ûï</span>
            {{ searchResult.inCollection ? 'Already Added' : 'Add to Collection' }}
          </button>
        </div>
      </div>
      
      <!-- No Results -->
      <div class="no-results" *ngIf="searchResult && !searchResult.oxford && !searchResult.inCollection">
        <div class="no-results-content">
          <div class="no-results-icon">‚ùå</div>
          <h4 class="no-results-title">Word Not Found</h4>
          <p class="no-results-message">
            The word "{{ searchResult.word }}" was not found in our collection or Oxford Dictionary.
          </p>
        </div>
      </div>
      
      <!-- Search Prompt -->
      <div class="search-prompt" *ngIf="!searchResult">
        <div class="prompt-content">
          <div class="prompt-icon">üîç</div>
          <h4 class="prompt-title">Search for a Word</h4>
          <p class="prompt-message">
            Enter a word in the search box to see detailed information displayed in organized cards.
          </p>
        </div>
      </div>
    </div>
    </div>
  </div>

  <div class="main-content">
    <!-- Puzzle Solver Panel (shown when puzzle panel is expanded) -->
    <div class="puzzle-solver-panel glass-effect slide-in" *ngIf="puzzlePanelExpanded">
      <div class="panel-container">
        <!-- Puzzle Setup Card -->
        <div class="puzzle-card glass-effect">
          <div class="card-header">
            <h2 class="card-title">
              <span class="title-icon">üß©</span>
              Interactive Word Puzzle
            </h2>
            <p class="card-subtitle">Find words matching your pattern</p>
          </div>
          
          <div class="puzzle-form">
            <div class="puzzle-inputs">
              <div class="input-group">
                <label for="puzzleLength" class="input-label">
                  Word Length
                  <span class="label-hint">Number of letters in the word</span>
                </label>
                <div class="input-wrapper">
                  <input 
                    type="number" 
                    id="puzzleLength"
                    [(ngModel)]="puzzleLength"
                    (input)="onPuzzleLengthChange()"
                    min="1"
                    max="20"
                    placeholder="5"
                    class="modern-input">
                  <div class="input-icon">üìè</div>
                </div>
              </div>
              
              <div class="input-group">
                <label for="puzzlePattern" class="input-label">
                  Pattern
                  <span class="label-hint">Use ? for unknown letters (e.g., ?a???)</span>
                </label>
                <div class="input-wrapper">
                  <input 
                    type="text" 
                    id="puzzlePattern"
                    [(ngModel)]="puzzlePattern"
                    (input)="onPuzzlePatternChange()"
                    [placeholder]="'e.g., ' + getPatternPlaceholder()"
                    class="modern-input">
                  <div class="input-icon">üéØ</div>
                </div>
              </div>
            </div>
            
            <div class="puzzle-actions">
              <button type="button" (click)="findMatchingWords()" class="btn btn-primary">
                <span class="btn-icon">üîç</span>
                Find Words Matching Pattern
              </button>
              <button type="button" (click)="clearInteractive()" class="btn btn-secondary">
                <span class="btn-icon">üóëÔ∏è</span>
                Clear All & Start Over
              </button>
              <button type="button" (click)="randomizePattern()" class="btn btn-accent">
                <span class="btn-icon">üé≤</span>
                Generate Random Puzzle
              </button>
            </div>
          </div>
        </div>

        <!-- Puzzle Results -->
        <div class="puzzle-results-card glass-effect" *ngIf="letterBoxes.length > 0">
          <div class="card-header">
            <h3 class="card-title">
              <span class="title-icon">üéØ</span>
              Puzzle Results
            </h3>
            <div class="result-badge" *ngIf="!interactiveLoading && !interactiveError && interactiveWords.length > 0">
              <span class="badge-icon">‚ú®</span>
              <span class="badge-label">{{ interactiveWords.length }} words found</span>
            </div>
          </div>

          <!-- Interactive Loading -->
          <div class="loading-container" *ngIf="interactiveLoading">
            <div class="modern-spinner">
              <div class="spinner-ring puzzle"></div>
              <div class="spinner-ring puzzle"></div>
              <div class="spinner-ring puzzle"></div>
            </div>
            <div class="loading-content">
              <h4 class="loading-title">Solving Puzzle</h4>
              <p class="loading-subtitle">Finding words matching your pattern...</p>
            </div>
          </div>

          <!-- Interactive Error -->
          <div class="error-container" *ngIf="interactiveError">
            <div class="error-content">
              <h4 class="error-title">Puzzle Error</h4>
              <p class="error-message">{{ interactiveError }}</p>
              <button class="btn btn-outline" (click)="findMatchingWords()">
                <span class="btn-icon">üîÑ</span>
                Try Again
              </button>
            </div>
          </div>

          <!-- Interactive Words Grid -->
          <div class="puzzle-words-grid" *ngIf="!interactiveLoading && !interactiveError && interactiveWords.length > 0">
            <div class="puzzle-word-card" *ngFor="let word of interactiveWords; trackBy: trackByWord">
              <div class="word-content">
                <span class="word-text">{{ word }}</span>
                <span class="word-length">{{ word.length }}</span>
              </div>
            </div>
          </div>

          <!-- No Interactive Results -->
          <div class="no-results" *ngIf="!interactiveLoading && !interactiveError && interactiveWords.length === 0 && letterBoxes.length > 0">
            <div class="no-results-content">
              <div class="no-results-icon">üß©</div>
              <h4 class="no-results-title">No Words Found</h4>
              <p class="no-results-message">
                No words match your current pattern. Try adjusting your pattern or word length.
              </p>
              <div class="no-results-suggestions">
                <h5>Suggestions:</h5>
                <ul>
                  <li>‚Ä¢ Use more ? wildcards in your pattern</li>
                  <li>‚Ä¢ Try a different word length</li>
                  <li>‚Ä¢ Check if your known letters are correct</li>
                  <li>‚Ä¢ Try a different combination</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>